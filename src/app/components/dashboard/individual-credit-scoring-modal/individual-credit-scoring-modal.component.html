<!-- Close Confirmation Modal -->
<div class="confirmation-overlay" *ngIf="showCloseConfirmation" (click)="cancelClose()">
  <div class="confirmation-modal" (click)="$event.stopPropagation()">
    <h3 class="confirmation-title">Are you sure you want to quit?</h3>
    <p class="confirmation-message">Any unsaved data will be lost</p>
    <div class="confirmation-buttons">
      <button class="btn-save" (click)="cancelClose()">No</button>
      <button class="btn-next" (click)="confirmClose()">Yes</button>
    </div>
  </div>
</div>
<div class="modal-overlay" (click)="close()">
  <div class="modal-container" (click)="$event.stopPropagation()">

    <!-- Modal Header -->
    <div class="modal-header">
      <div class="header-left">
        <img src="assets/images/accuris-logo.png" alt="Accuris Logo" class="modal-logo" />
      </div>
      <h2 class="modal-title">INDIVIDUAL CREDIT SCORING FORM</h2>
      <button class="close-btn" (click)="close()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <!-- Plan Info -->
    <div class="plan-info">
      <div class="plan-label">
        Plan: <span class="plan-name">{{selectedPlanInput}}</span>
      </div>
      <div class="for-label">For: <span class="plan-name">{{currentUserName}}</span></div>
    </div>

    <!-- Steps Navigation -->
    <div class="steps-container">
      <div
        *ngFor="let step of steps"
        class="step-item"
        [class.active]="currentStep === step.id"
        (click)="onStepClick(step.id)"
      >
        <div class="step-icon">
          <img *ngIf="step.icon === 'user'" src="assets/images/icons/person-info-icon.svg" alt="Person Info" width="28" height="28" />
          <img *ngIf="step.icon === 'location'" src="assets/images/icons/location-icon.svg" alt="Location" width="28" height="28" />
          <img *ngIf="step.icon === 'finance'" src="assets/images/icons/financial-icon.svg" alt="Financial" width="28" height="28" />
          <img *ngIf="step.icon === 'upload'" src="assets/images/icons/upload-icon.svg" alt="Upload" width="28" height="28" />
          <img *ngIf="step.icon === 'consent'" src="assets/images/icons/user-consent-icon.svg" alt="Consent" width="28" height="28" />
        </div>
        <span class="step-name">{{ step.name }}</span>
      </div>
    </div>

    <!-- Form Content - Person's Information -->
    <div class="form-content" *ngIf="currentStep === 1">
      <h3 class="form-title">Person's Information</h3>
      <p class="form-subtitle">Provide your Person's Information below</p>

      <form [formGroup]="personalInfoForm" class="form-step">

        <div class="form-row">
          <div class="form-group half">
            <input type="text" formControlName="firstName" placeholder="First Name" class="form-input" [class.filled]="personalInfoForm.get('firstName')?.value" />
          </div>
          <div class="form-group half">
            <input type="text" formControlName="lastName" placeholder="Last Name" class="form-input" [class.filled]="personalInfoForm.get('lastName')?.value" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <input type="text" formControlName="fathersName" placeholder="Father's Name" class="form-input" [class.filled]="personalInfoForm.get('fathersName')?.value" />
          </div>
          <div class="form-group half">
            <input type="text" formControlName="mothersName" placeholder="Mother's Name" class="form-input" [class.filled]="personalInfoForm.get('mothersName')?.value" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <input type="date" formControlName="dateOfBirth" placeholder="Date of Birth" class="form-input" [class.filled]="personalInfoForm.get('dateOfBirth')?.value" />
          </div>
          <div class="form-group half">
            <select formControlName="gender" class="form-input form-select" [class.filled]="personalInfoForm.get('gender')?.value">
              <option value="" disabled selected>Gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <select formControlName="maritalStatus" class="form-input form-select" [class.filled]="personalInfoForm.get('maritalStatus')?.value">
              <option value="" disabled selected>Marital Status</option>
              <option value="single">Single</option>
              <option value="married">Married</option>
              <option value="divorced">Divorced</option>
              <option value="widowed">Widowed</option>
            </select>
          </div>
          <div class="form-group half">
            <input type="text" formControlName="idNumber" placeholder="ID Number" class="form-input" [class.filled]="personalInfoForm.get('idNumber')?.value" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <input type="tel" formControlName="phoneNumber" placeholder="Phone Number" class="form-input" [class.filled]="personalInfoForm.get('phoneNumber')?.value" />
          </div>
          <div class="form-group half">
            <input type="email" formControlName="email" placeholder="Email Address" class="form-input" [class.filled]="personalInfoForm.get('email')?.value" />
          </div>
        </div>

<!--        <div class="form-row">-->
<!--          <div class="form-group full">-->
<!--            <div class="upload-container" (click)="triggerFileInput()" [class.filled]="selectedFileName">-->
<!--              <input type="file" #fileInput id="fileUpload" (change)="onFileSelected($event)" style="display: none;" accept=".pdf,.jpg,.jpeg,.png" />-->
<!--              <span class="upload-placeholder">{{ selectedFileName || 'Upload ID' }}</span>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->

        <div class="button-row">
          <button type="button" class="btn-save" (click)="onSaveAll()">SAVE</button>
          <button type="button" class="btn-next" [disabled]="personalInfoForm.invalid" >NEXT</button>
        </div>
      </form>
    </div>


    <!-- Form Content - Location -->
    <div class="form-content" *ngIf="currentStep === 2">
      <h3 class="form-title">Location</h3>
      <p class="form-subtitle">Provide your address below</p>

      <form [formGroup]="locationForm" style="display: flex; flex-direction: column; align-items: center; width: 65%;">

        <!-- Present Address -->
        <div class="form-row">
          <div class="form-group full">
            <input
              type="text"
              formControlName="presentAddress"
              placeholder="Present Address"
              class="form-input"
              [class.filled]="locationForm.get('presentAddress')?.value"
            />
          </div>
        </div>

        <!-- Permanent Address -->
        <div class="form-row">
          <div class="form-group full">
            <input
              type="text"
              formControlName="permanentAddress"
              placeholder="Permanent Address"
              class="form-input"
              [class.filled]="locationForm.get('permanentAddress')?.value"
            />
          </div>
        </div>

        <!-- City and State/District -->
        <div class="form-row">
          <div class="form-group half">
            <input
              type="text"
              formControlName="city"
              placeholder="City"
              class="form-input"
              [class.filled]="locationForm.get('city')?.value"
            />
          </div>
          <div class="form-group half">
            <select
              formControlName="stateOrDistrict"
              class="form-input form-select"
              [class.filled]="locationForm.get('stateOrDistrict')?.value"
            >
              <option value="" disabled selected>State / District</option>
              <option value="dhaka">Dhaka</option>
              <option value="chittagong">Chittagong</option>
              <option value="rajshahi">Rajshahi</option>
              <option value="khulna">Khulna</option>
              <option value="barisal">Barisal</option>
              <option value="sylhet">Sylhet</option>
              <option value="rangpur">Rangpur</option>
              <option value="mymensingh">Mymensingh</option>
            </select>
          </div>
        </div>

        <!-- Postal Code and Country -->
        <div class="form-row">
          <div class="form-group half">
            <input
              type="text"
              formControlName="postalCode"
              placeholder="Postal Code"
              class="form-input"
              [class.filled]="locationForm.get('postalCode')?.value"
            />
          </div>
          <div class="form-group half">
            <select
              formControlName="country"
              class="form-input form-select"
              [class.filled]="locationForm.get('country')?.value"
            >
              <option value="" disabled selected>Country</option>
              <option value="bangladesh">Bangladesh</option>
              <option value="india">India</option>
              <option value="pakistan">Pakistan</option>
              <option value="nepal">Nepal</option>
              <option value="sri-lanka">Sri Lanka</option>
              <option value="bhutan">Bhutan</option>
              <option value="maldives">Maldives</option>
              <option value="usa">United States</option>
              <option value="uk">United Kingdom</option>
              <option value="canada">Canada</option>
            </select>
          </div>
        </div>

        <!-- Length of Stay -->
        <div class="form-row">
          <div class="form-group half">
            <input
              type="number"
              formControlName="lengthOfStay"
              placeholder="Length of Stay (Years)"
              class="form-input"
              [class.filled]="locationForm.get('lengthOfStay')?.value"
              min="0"
            />
          </div>
        </div>

        <div class="button-row">
          <button type="button" class="btn-save" (click)="onSaveAll()">SAVE</button>
          <button
            type="button"
            class="btn-next"
            [disabled]="locationForm.invalid"

          >
            NEXT
          </button>
        </div>
      </form>
    </div>


    <!-- Form Content - Financial Information -->
    <div class="form-content financial-content" *ngIf="currentStep === 3">
      <h3 class="form-title">Financial Information</h3>
      <p class="form-subtitle">Provide your Financial Information below</p>

      <div class="accordion-container">

        <!-- 1. Basic Information -->
        <div class="accordion-item" [class.completed]="financialSections.basicInfo">
          <div class="accordion-header" (click)="toggleAccordion('basicInfo')">
            <div class="accordion-title">
              <svg *ngIf="financialSections.basicInfo" class="check-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <svg *ngIf="!financialSections.basicInfo" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
              </svg>
              <span>Basic Information</span>
            </div>
            <svg class="chevron-icon" [class.rotate]="expandedSection === 'basicInfo'" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="accordion-content" *ngIf="expandedSection === 'basicInfo'">
            <form [formGroup]="basicInfoForm">
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="creditPurpose" class="form-input form-select" [class.filled]="basicInfoForm.get('creditPurpose')?.value">
                    <option value="" disabled selected>Credit Purpose</option>
                    <option value="1">Loan Application</option>
                    <option value="2">Investor / Partner Review</option>
                    <option value="3">Supplier / Vendor Assessment</option>
                    <option value="4">Advertisement / Public Rating</option>
                    <option value="5">Self-Assessment</option>
                    <option value="6">Other</option>
                  </select>
                </div>
                <div class="form-group half">
                  <select formControlName="incomeType" class="form-input form-select" [class.filled]="basicInfoForm.get('incomeType')?.value">
                    <option value="" disabled selected>Income Type</option>
                    <option value="1">Salaried</option>
                    <option value="2">Self-Employed / Business</option>
                    <option value="3">Contractual</option>
                    <option value="4">Rental</option>
                    <option value="5">Investment</option>
                    <option value="6">Multiple Sources</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- 2. Employment Information -->
        <div class="accordion-item" [class.completed]="financialSections.employerInfo">
          <div class="accordion-header" (click)="toggleAccordion('employerInfo')">
            <div class="accordion-title">
              <svg *ngIf="financialSections.employerInfo" class="check-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <svg *ngIf="!financialSections.employerInfo" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
              </svg>
              <span>Employment Information</span>
            </div>
            <svg class="chevron-icon" [class.rotate]="expandedSection === 'employerInfo'" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="accordion-content" *ngIf="expandedSection === 'employerInfo'">
            <form [formGroup]="employerInfoForm">
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="employerType" class="form-input form-select" [class.filled]="employerInfoForm.get('employerType')?.value">
                    <option value="" disabled selected>Employer Type</option>
                    <option value="1">Government</option>
                    <option value="2">Private</option>
                    <option value="3">NGO</option>
                    <option value="4">Self-Employed</option>
                  </select>
                </div>
                <div class="form-group half">
                  <input type="text" formControlName="employerName" placeholder="Employer Name" class="form-input" [class.filled]="employerInfoForm.get('employerName')?.value" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="employmentStatus" class="form-input form-select" [class.filled]="employerInfoForm.get('employmentStatus')?.value">
                    <option value="" disabled selected>Employment Status</option>
                    <option value="1">Permanent</option>
                    <option value="2">Contract</option>
                  </select>
                </div>
                <div class="form-group half">
                  <input type="text" formControlName="jobDesignation" placeholder="Job Designation" class="form-input" [class.filled]="employerInfoForm.get('jobDesignation')?.value" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="jobTenureYears" placeholder="Job Tenure (Years)" class="form-input" [class.filled]="employerInfoForm.get('jobTenureYears')?.value" min="0" />
                </div>
                <div class="form-group half">
                  <input type="number" formControlName="monthlyGrossIncome" placeholder="Monthly Gross Income" class="form-input" [class.filled]="employerInfoForm.get('monthlyGrossIncome')?.value" min="0" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="monthlyNetIncome" placeholder="Monthly Net Income" class="form-input" [class.filled]="employerInfoForm.get('monthlyNetIncome')?.value" min="0" />
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- 3. Business Information -->
        <div class="accordion-item" [class.completed]="financialSections.businessInfo">
          <div class="accordion-header" (click)="toggleAccordion('businessInfo')">
            <div class="accordion-title">
              <svg *ngIf="financialSections.businessInfo" class="check-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <svg *ngIf="!financialSections.businessInfo" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
              </svg>
              <span>Business Information</span>
            </div>
            <svg class="chevron-icon" [class.rotate]="expandedSection === 'businessInfo'" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="accordion-content" *ngIf="expandedSection === 'businessInfo'">
            <form [formGroup]="businessInfoForm">
              <div class="form-row">
                <div class="form-group full">
                  <input type="text" formControlName="businessName" placeholder="Business Name" class="form-input" [class.filled]="businessInfoForm.get('businessName')?.value" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="businessType" class="form-input form-select" [class.filled]="businessInfoForm.get('businessType')?.value">
                    <option value="" disabled selected>Business Type / Nature</option>
                    <option value="1">Trading</option>
                    <option value="2">Service</option>
                  </select>
                </div>
                <div class="form-group half">
                  <input type="text" formControlName="industryType" placeholder="Industry Type" class="form-input" [class.filled]="businessInfoForm.get('industryType')?.value" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="yearsInBusiness" placeholder="Years in Business" class="form-input" [class.filled]="businessInfoForm.get('yearsInBusiness')?.value" min="0" />
                </div>
                <div class="form-group half">
                  <input type="number" formControlName="monthlyBusinessIncome" placeholder="Monthly Business Income" class="form-input" [class.filled]="businessInfoForm.get('monthlyBusinessIncome')?.value" min="0" />
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- 4. Financial and Credit Information -->
        <div class="accordion-item" [class.completed]="financialSections.creditInfo">
          <div class="accordion-header" (click)="toggleAccordion('creditInfo')">
            <div class="accordion-title">
              <svg *ngIf="financialSections.creditInfo" class="check-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <svg *ngIf="!financialSections.creditInfo" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
              </svg>
              <span>Financial and Credit Information</span>
            </div>
            <svg class="chevron-icon" [class.rotate]="expandedSection === 'creditInfo'" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="accordion-content" *ngIf="expandedSection === 'creditInfo'">
            <form [formGroup]="creditInfoForm">
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="requestedLoanAmount" placeholder="Requested Loan Amount" class="form-input" [class.filled]="creditInfoForm.get('requestedLoanAmount')?.value" min="0" />
                </div>
                <div class="form-group half">
                  <input type="number" formControlName="downPaymentAmount" placeholder="Down Payment Amount" class="form-input" [class.filled]="creditInfoForm.get('downPaymentAmount')?.value" min="0" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="loanTenureMonths" placeholder="Loan Tenure (Months)" class="form-input" [class.filled]="creditInfoForm.get('loanTenureMonths')?.value" min="0" />
                </div>
                <div class="form-group half">
                  <select formControlName="repaymentPreference" class="form-input form-select" [class.filled]="creditInfoForm.get('repaymentPreference')?.value">
                    <option value="" disabled selected>Repayment Preference</option>
                    <option value="1">EMI</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group full">
                  <textarea formControlName="existingLoanDetails" placeholder="Existing Loan Details" class="form-input" rows="3" [class.filled]="creditInfoForm.get('existingLoanDetails')?.value"></textarea>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group full">
                  <textarea formControlName="creditCardDetails" placeholder="Credit Card Details" class="form-input" rows="3" [class.filled]="creditInfoForm.get('creditCardDetails')?.value"></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- 5. Security / Collateral & Risk Mitigation -->
        <div class="accordion-item" [class.completed]="financialSections.securityInfo">
          <div class="accordion-header" (click)="toggleAccordion('securityInfo')">
            <div class="accordion-title">
              <svg *ngIf="financialSections.securityInfo" class="check-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <svg *ngIf="!financialSections.securityInfo" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
              </svg>
              <span>Security / Collateral & Risk Mitigation</span>
            </div>
            <svg class="chevron-icon" [class.rotate]="expandedSection === 'securityInfo'" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="accordion-content" *ngIf="expandedSection === 'securityInfo'">
            <form [formGroup]="securityInfoForm">
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="collateralAvailable" class="form-input form-select" [class.filled]="securityInfoForm.get('collateralAvailable')?.value">
                    <option value="" disabled selected>Collateral Available</option>
                    <option value="1">Yes</option>
                    <option value="0">No</option>
                  </select>
                </div>
                <div class="form-group half">
                  <select formControlName="collateralType" class="form-input form-select" [class.filled]="securityInfoForm.get('collateralType')?.value">
                    <option value="" disabled selected>Collateral Type</option>
                    <option value="1">Property</option>
                    <option value="2">FDR</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <input type="number" formControlName="estimatedCollateralValue" placeholder="Estimated Collateral Value" class="form-input" [class.filled]="securityInfoForm.get('estimatedCollateralValue')?.value" min="0" />
                </div>
                <div class="form-group half">
                  <select formControlName="guarantorAvailable" class="form-input form-select" [class.filled]="securityInfoForm.get('guarantorAvailable')?.value">
                    <option value="" disabled selected>Guarantor Available</option>
                    <option value="1">Yes</option>
                    <option value="0">No</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group half">
                  <select formControlName="coApplicantAvailable" class="form-input form-select" [class.filled]="securityInfoForm.get('coApplicantAvailable')?.value">
                    <option value="" disabled selected>Co-Applicant Available</option>
                    <option value="1">Yes</option>
                    <option value="0">No</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
        </div>

      </div>

      <div class="button-row financial-buttons">
        <button type="button" class="btn-save" (click)="onSaveAll()">SAVE</button>
        <button type="button" class="btn-next" [disabled]="basicInfoForm.invalid || employerInfoForm.invalid || businessInfoForm.invalid || creditInfoForm.invalid || securityInfoForm.invalid" >NEXT</button>
      </div>
    </div>

    <!-- Form Content - Upload Information (Step 4) -->
    <div class="form-content upload-content" *ngIf="currentStep === 4">
      <h3 class="form-title">Upload Information</h3>
      <p class="form-subtitle">Provide your Upload Information below</p>

      <form style="width:  100%; display: flex; flex-direction: column; align-items: center;" [formGroup]="uploadForm">
        <div class="upload-sections-container">

          <!-- 1. Identity & Verification -->
          <div class="upload-section" [class.completed]="uploadSections.identity" [class.expanded]="expandedUploadSection === 'identity'">
            <div class="upload-section-header" (click)="toggleUploadSection('identity')">
              <div class="upload-section-title">
                <svg *ngIf="uploadSections.identity" class="check-icon" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                  <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg *ngIf="!uploadSections.identity" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
                </svg>
                <span>Identity & Verification</span>
              </div>
              <div class="upload-icons">
                <svg class="info-icon-upload" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#20C0A0">
                  <circle cx="12" cy="12" r="10" stroke-width="2"/>
                  <path d="M12 16v-4M12 8h.01" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <svg class="chevron-icon" [class.rotate]="expandedUploadSection === 'identity'" width="16" height="16" viewBox="0 0 16 16">
                  <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
            <div class="upload-section-content" *ngIf="expandedUploadSection === 'identity'">

              <!-- National ID Copy -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="ID Copy"
                  class="upload-field"
                  [value]="uploadForm.get('idCopy')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('idCopy')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #idCopyInput
                  style="display:none"
                  (change)="onUploadFile($event, 'idCopy')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

              <!-- Photograph -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="Photograph"
                  class="upload-field"
                  [value]="uploadForm.get('photograph')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('photograph')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #photographInput
                  style="display:none"
                  (change)="onUploadFile($event, 'photograph')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

            </div>
          </div>

          <!-- 2. Employment Documents -->
          <div class="upload-section" [class.completed]="uploadSections.employment" [class.expanded]="expandedUploadSection === 'employment'">
            <div class="upload-section-header" (click)="toggleUploadSection('employment')">
              <div class="upload-section-title">
                <svg *ngIf="uploadSections.employment" class="check-icon" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                  <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg *ngIf="!uploadSections.employment" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
                </svg>
                <span>Employment Documents</span>
              </div>
              <div class="upload-icons">
                <svg class="info-icon-upload" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#20C0A0">
                  <circle cx="12" cy="12" r="10" stroke-width="2"/>
                  <path d="M12 16v-4M12 8h.01" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <svg class="chevron-icon" [class.rotate]="expandedUploadSection === 'employment'" width="16" height="16" viewBox="0 0 16 16">
                  <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
            <div class="upload-section-content" *ngIf="expandedUploadSection === 'employment'">

              <!-- Salary Certificate -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="Salary Certificate"
                  class="upload-field"
                  [value]="uploadForm.get('salaryCertificate')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('salaryCertificate')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #salaryCertificateInput
                  style="display:none"
                  (change)="onUploadFile($event, 'salaryCertificate')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

            </div>
          </div>

          <!-- 3. Credit Verification -->
          <div class="upload-section" [class.completed]="uploadSections.credit" [class.expanded]="expandedUploadSection === 'credit'">
            <div class="upload-section-header" (click)="toggleUploadSection('credit')">
              <div class="upload-section-title">
                <svg *ngIf="uploadSections.credit" class="check-icon" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                  <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg *ngIf="!uploadSections.credit" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
                </svg>
                <span>Credit Verification</span>
              </div>
              <div class="upload-icons">
                <svg class="info-icon-upload" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#20C0A0">
                  <circle cx="12" cy="12" r="10" stroke-width="2"/>
                  <path d="M12 16v-4M12 8h.01" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <svg class="chevron-icon" [class.rotate]="expandedUploadSection === 'credit'" width="16" height="16" viewBox="0 0 16 16">
                  <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
            <div class="upload-section-content" *ngIf="expandedUploadSection === 'credit'">

              <!-- Bank Statement -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="Bank Statement"
                  class="upload-field"
                  [value]="uploadForm.get('bankStatement')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('bankStatement')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #bankStatementInput
                  style="display:none"
                  (change)="onUploadFile($event, 'bankStatement')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

              <!-- Income Tax Return -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="Income Tax Return"
                  class="upload-field"
                  [value]="uploadForm.get('incomeTaxReturn')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('incomeTaxReturn')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #incomeTaxReturnInput
                  style="display:none"
                  (change)="onUploadFile($event, 'incomeTaxReturn')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

              <!-- CIB Consent Form -->
              <div class="upload-field-group full-width">
                <input
                  type="text"
                  placeholder="CIB Consent Form"
                  class="upload-field"
                  [value]="uploadForm.get('cibConsentForm')?.value || ''"
                  readonly
                />
                <button type="button" class="upload-btn-icon" (click)="triggerUploadInput('cibConsentForm')">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#20C0A0" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <input
                  type="file"
                  #cibConsentFormInput
                  style="display:none"
                  (change)="onUploadFile($event, 'cibConsentForm')"
                  accept=".pdf,.jpg,.jpeg,.png"
                />
              </div>

            </div>
          </div>

          <!-- 4. Final Declaration -->
          <div class="upload-section" [class.completed]="uploadForm.get('finalDeclaration')?.value" [class.expanded]="expandedUploadSection === 'declaration'">
            <div class="upload-section-header" (click)="toggleUploadSection('declaration')">
              <div class="upload-section-title">
                <svg *ngIf="uploadForm.get('finalDeclaration')?.value" class="check-icon" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="10" fill="#20C0A0"/>
                  <path d="M6 10l3 3 5-6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg *ngIf="!uploadForm.get('finalDeclaration')?.value" class="check-icon-empty" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="9" stroke="#D0D0D0" stroke-width="2" fill="none"/>
                </svg>
                <span>Final Declaration</span>
              </div>
              <div class="upload-icons">
                <svg class="info-icon-upload" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#20C0A0">
                  <circle cx="12" cy="12" r="10" stroke-width="2"/>
                  <path d="M12 16v-4M12 8h.01" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <svg class="chevron-icon" [class.rotate]="expandedUploadSection === 'declaration'" width="16" height="16" viewBox="0 0 16 16">
                  <path d="M4 6L8 10L12 6" stroke="#20C0A0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
            <div class="upload-section-content" *ngIf="expandedUploadSection === 'declaration'">
              <label class="checkbox-label" style="display: flex; align-items: flex-start; gap: 10px; cursor: pointer;">
                <input
                  type="checkbox"
                  formControlName="finalDeclaration"
                  class="checkbox-input"
                  style="margin-top: 4px;"
                />
                <span class="checkbox-text" style="flex: 1;">
              I hereby declare that all information provided is true and accurate
            </span>
              </label>
            </div>
          </div>

        </div>

        <div class="button-row upload-buttons">
          <button type="button" class="btn-save" (click)="onSaveAll()">SAVE</button>
          <button type="button" class="btn-next" [disabled]="uploadForm.invalid" >NEXT</button>
        </div>
      </form>
    </div>

    <!-- Form Content - User Consent -->
    <div class="form-content consent-content" *ngIf="currentStep === 5">
      <h3 class="form-title">Consent</h3>
      <p class="form-subtitle consent-subtitle">YOUR DATA IS SACRED TO US AND WE DO NOT DISCLOSE IT TO ANY THIRD PARTY EXCEPT OUR AI ENGINE</p>

      <div class="consent-container">
        <div class="consent-box">
          <h4 class="consent-box-title">User Consent Form</h4>
          <div class="consent-text">
            <p><strong>Before using the Accuris platform, please read the following carefully:</strong></p>
            <p>By continuing, you agree to share certain information with us so that we can assess your credit profile, generate reports, and help you understand your financial standing.</p>
            <p>Your privacy and data security are our top priorities â€” every step follows strict data protection and confidentiality measures.</p>

            <p><strong>Terms and Conditions:</strong></p>
            <ol>
              <li><strong>Purpose of Service:</strong><br/>
                The Accuris platform provides credit assessment, analysis, and recommendations based on data entered by users and verified third-party sources.</li>

              <li><strong>User Responsibility:</strong><br/>
                Users must provide accurate, complete, and up-to-date information. False or misleading data may affect the accuracy of the generated credit ratings.</li>

              <li><strong>Use of Results:</strong><br/>
                The generated credit score, analysis, or recommendations are for informational and decision support purposes only. The system does not guarantee loan approvals or investment outcomes.</li>

              <li><strong>Data Accuracy:</strong><br/>
                While we strive for precision, all generated results are subject to data quality and algorithmic limitations.</li>

              <li><strong>Account Management:</strong><br/>
                Users are responsible for maintaining the confidentiality of their login credentials and any activities under their account.</li>

              <li><strong>Limitation of Liability:</strong><br/>
                Accuris is not liable for any financial decisions made based on the platform's analysis. Users should consult professional advisors before making significant financial commitments.</li>
            </ol>
          </div>
        </div>

        <div class="consent-checkbox-container">
          <label class="consent-checkbox-label">
            <input type="checkbox" [(ngModel)]="consentAccepted" class="consent-checkbox" />
            <span class="checkbox-text">I have read the privacy policy and terms of service and agree to open my account regardless</span>
          </label>
        </div>
      </div>

      <div class="button-row consent-buttons">
        <button type="button" class="btn-save" (click)="onSaveAll()">SAVE</button>
        <button type="button" class="btn-next" [disabled]="!consentAccepted" (click)="onSaveAll(true)">Submit</button>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="return-home-btn" >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Return Home
      </button>
    </div>

  </div>
</div>
